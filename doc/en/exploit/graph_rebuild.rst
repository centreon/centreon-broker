.. _exploit_graph_rebuild:

#############
Graph rebuild
#############

Centreon Broker can rebuild graphs that it generates. The rebuild
process is separated in two phases. Rebuild checks and orders generation
take place in :ref:`storage endpoints <user_modules_storage>` whereas
actual rebuild (RRD file deletion, recreation and update) is done in
:ref:`RRD endpoints <user_modules_rrd>`. With a standard Centreon setup,
the rebuild process can be entirely controlled from Centreon. Check the
Centreon manual for more information.

In storage endpoints
====================

Storage endpoints check the database they're connected to regularly for
graphs to rebuild. This is determined by the *must_be_rebuild* field of
the **metrics** table. When *must_be_rebuild* is set to '1', the rebuild
process is engaged for the graph:

* the *must_be_rebuild* flag is set to '2' (*in rebuild*)
* *rebuild start* order is sent
* historical data is collected from the **data_bin** table
* historical data is sent
* *rebuild end* order is sent
* the *must_be_rebuild* flag is set to '0' (*no rebuild*)

In RRD endpoints
================

Nothing particular here. The RRD endpoints wait for rebuild orders. Once
received, existing RRD graph is deleted and rebuild with historical data
generated by storage endpoints.
